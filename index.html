<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FedEx Elite V49</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --fedex-purple: #4D148C; --fedex-orange: #FF6200; }
        body { font-family: 'Cairo', sans-serif; background-color: #F4F7FE; padding-bottom: 110px; margin: 0; overflow-x: hidden; }
        
        #splash {
            position: fixed; inset: 0; background: #ffffff;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 9999; transition: all 0.8s cubic-bezier(0.9, 0, 0.1, 1);
        }
        .splash-logo { 
            font-size: 70px; font-weight: 900; font-style: italic; letter-spacing: -4px;
            transform: scale(0); animation: logoPop 1s cubic-bezier(0.17, 0.67, 0.83, 0.67) forwards;
        }
        .welcome-text {
            margin-top: 30px; font-size: 22px; font-weight: 900; color: var(--fedex-purple);
            opacity: 0; transform: translateY(20px);
            animation: textSlideUp 0.8s ease-out forwards 0.8s;
            position: relative;
        }
        .welcome-text::after {
            content: ''; position: absolute; bottom: -5px; right: 0; width: 0; height: 3px;
            background: var(--fedex-orange); animation: lineGrow 0.6s ease-out forwards 1.4s;
        }
        @keyframes logoPop { 0% { transform: scale(0); filter: blur(10px); } 70% { transform: scale(1.2); filter: blur(0); } 100% { transform: scale(1); } }
        @keyframes textSlideUp { to { opacity: 1; transform: translateY(0); } }
        @keyframes lineGrow { to { width: 100%; } }
        .fade-out-up { transform: translateY(-100%); opacity: 0; pointer-events: none; }

        .add-btn-main {
            width: 75px; height: 75px;
            background: linear-gradient(135deg, var(--fedex-purple) 0%, #320d5c 100%);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            color: white; border: 5px solid #F4F7FE;
            transform: translateY(-32px);
            box-shadow: 0 10px 25px rgba(77, 20, 140, 0.4);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
        }
        .add-btn-main:active { transform: translateY(-32px) scale(0.8) rotate(90deg); }
        .add-btn-main svg { width: 35px; height: 35px; stroke-width: 3; }

        .card-shadow { box-shadow: 0 10px 25px -5px rgba(77, 20, 140, 0.08); }
        .purple-gradient { background: linear-gradient(135deg, #4D148C 0%, #2E0B54 100%); border-radius: 30px; }
        .screen { display: none; padding: 20px; animation: fadeIn 0.4s ease; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        #renderArea { width: 500px; background: white; padding: 40px; position: fixed; left: -9999px; }
        .nav-bar { position: fixed; bottom: 0; left: 0; right: 0; height: 85px; background: white; display: flex; align-items: center; z-index: 1000; box-shadow: 0 -10px 30px rgba(0,0,0,0.05); }
    </style>
</head>
<body>

    <div id="splash">
        <div class="splash-logo">
            <span style="color:var(--fedex-purple)">Fed</span><span style="color:var(--fedex-orange)">Ex</span>
        </div>
        <div class="welcome-text">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø£Ø­Ù…Ø¯ ÙˆÙ„ÙŠØ¯</div>
    </div>

    <header class="p-6 flex justify-between items-center bg-white card-shadow mb-4">
        <div class="text-3xl font-black italic tracking-tighter">
            <span style="color:var(--fedex-purple)">Fed</span><span style="color:var(--fedex-orange)">Ex</span>
        </div>
        <div class="px-4 py-2 rounded-2xl bg-purple-50 text-purple-900 font-black text-[11px] italic uppercase">Ahmed Walid</div>
    </header>

    <main>
        <section id="home" class="screen active">
            <div class="purple-gradient p-8 text-white shadow-2xl mb-6 text-center">
                <p class="text-[10px] opacity-60 font-bold uppercase tracking-widest mb-1 text-orange-200">Ø§Ù„Ø±ØµÙŠØ¯ Ø¹Ù†Ø¯ Ø§Ù„Ø´Ø±ÙƒØ©</p>
                <h2 id="atCompany" class="text-5xl font-black italic mb-6">â‚¬0.00</h2>
                <div class="grid grid-cols-2 gap-4 border-t border-white/10 pt-5">
                    <div>
                        <p class="text-[10px] opacity-50 uppercase font-bold">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ø±ÙˆØ¯</p>
                        <p id="sumEarn" class="font-black text-xl">0â‚¬</p>
                    </div>
                    <div>
                        <p class="text-[10px] opacity-50 uppercase font-bold text-orange-400">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø­Ø¨</p>
                        <p id="sumWith" class="font-black text-xl text-orange-400">0â‚¬</p>
                    </div>
                </div>
            </div>
            <div class="bg-white p-6 rounded-[25px] card-shadow border-r-[10px] border-emerald-500 flex justify-between items-center">
                <span class="text-xs font-black text-slate-400 uppercase">Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØµØ§ÙÙŠ (ÙƒØ§Ø´ Ø§Ù„Ø¬ÙŠØ¨)</span>
                <span id="netProfit" class="text-2xl font-black text-emerald-600">0â‚¬</span>
            </div>
        </section>

        <section id="history" class="screen">
            <div class="bg-white p-6 rounded-[30px] card-shadow mb-6 border border-slate-50">
                <h4 class="text-center font-black text-slate-700 mb-4 text-xs italic">Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙØ§ØªÙˆØ±Ø© ÙØªØ±Ø©</h4>
                <div class="grid grid-cols-2 gap-3 mb-4">
                    <input type="date" id="dateFrom" class="p-3 bg-slate-50 rounded-xl text-xs font-bold border-none outline-none">
                    <input type="date" id="dateTo" class="p-3 bg-slate-50 rounded-xl text-xs font-bold border-none outline-none">
                </div>
                <button onclick="exportCustomReport()" class="w-full py-4 bg-purple-900 text-white rounded-2xl font-black text-xs italic uppercase shadow-lg active:scale-95 transition">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ğŸ“¸</button>
            </div>
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-black text-slate-800 italic uppercase">Log</h3>
                <button onclick="clearCurrentMonth()" class="text-[10px] font-black text-red-400">Clear Month</button>
            </div>
            <div id="logContainer" class="space-y-3"></div>
        </section>

        <section id="add" class="screen">
            <div class="bg-white p-8 rounded-[40px] card-shadow">
                <div class="flex bg-slate-100 p-2 rounded-2xl mb-8">
                    <button id="mD" onclick="setM('d')" class="flex-1 py-4 rounded-xl font-black text-xs bg-white text-purple-900 shadow-sm">ğŸ“¦ Ø·Ø±ÙˆØ¯</button>
                    <button id="mW" onclick="setM('w')" class="flex-1 py-4 rounded-xl font-black text-xs text-slate-400">ğŸ’¸ Ø³Ø­Ø¨</button>
                </div>
                <input type="date" id="iDate" class="w-full mb-6 p-4 rounded-xl bg-slate-50 font-bold outline-none">
                <input type="number" id="iVal" placeholder="0" class="w-full mb-8 p-10 rounded-3xl bg-slate-50 text-center font-black text-6xl outline-none border-2 border-transparent focus:border-purple-200">
                <button onclick="save()" class="w-full py-6 rounded-3xl bg-[#4D148C] text-white font-black text-xl shadow-xl">Ø­ÙØ¸ Ø§Ù„Ø¢Ù†</button>
            </div>
        </section>
    </main>

    <div id="renderArea">
        <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:6px solid #FF6200; padding-bottom:20px; margin-bottom:30px;">
            <div style="font-size:45px; font-weight:900; font-style:italic;"><span style="color:#4D148C">Fed</span><span style="color:#FF6200">Ex</span></div>
            <div style="text-align:right;">
                <div style="font-weight:900; font-size:20px; color:#4D148C;">AHMED WALID</div>
                <div id="repPeriod" style="font-size:12px; font-weight:bold; color:#888;"></div>
            </div>
        </div>
        <table style="width:100%; border-collapse:collapse; margin-bottom:30px;">
            <thead>
                <tr style="background:#F4F7FE; text-align:right;">
                    <th style="padding:15px; border-bottom:2px solid #ddd;">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                    <th style="padding:15px; border-bottom:2px solid #ddd;">Ø§Ù„Ø·Ø±ÙˆØ¯</th>
                    <th style="padding:15px; border-bottom:2px solid #ddd;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                </tr>
            </thead>
            <tbody id="repBody" style="font-weight:bold;"></tbody>
        </table>
        <div id="repFooter" style="background:#4D148C; color:white; padding:35px; border-radius:30px; display:flex; justify-content:space-between; align-items:center;"></div>
    </div>

    <nav class="nav-bar">
        <div onclick="tab('home')" class="flex-1 flex flex-col items-center text-slate-300 cursor-pointer"><svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2.5" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg></div>
        <div onclick="tab('add')" class="add-btn-main">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 6v12m6-6H6"></path></svg>
        </div>
        <div onclick="tab('history')" class="flex-1 flex flex-col items-center text-slate-300 cursor-pointer"><svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>
    </nav>

    <script>
        const P = 3.8, G = 35;
        let db = JSON.parse(localStorage.getItem('fedex_final_v49')) || { logs: [] };
        let mode = 'd';

        window.onload = function() {
            setTimeout(function() {
                document.getElementById('splash').classList.add('fade-out-up');
            }, 2500);
            
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('dateFrom').value = today; 
            document.getElementById('dateTo').value = today;
            document.getElementById('iDate').value = today;
            calc();
        };

        function tab(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if(id === 'home') calc(); else if(id === 'history') hist();
        }

        function setM(m) {
            mode = m;
            document.getElementById('mD').className = m==='d' ? 'flex-1 py-4 rounded-xl font-black text-xs bg-white text-purple-900 shadow-sm' : 'flex-1 py-4 rounded-xl font-black text-xs text-slate-400';
            document.getElementById('mW').className = m==='w' ? 'flex-1 py-4 rounded-xl font-black text-xs bg-white text-orange-600 shadow-sm' : 'flex-1 py-4 rounded-xl font-black text-xs text-slate-400';
        }

        function save() {
            const d = document.getElementById('iDate').value;
            const v = parseFloat(document.getElementById('iVal').value) || 0;
            if(!v) return;
            db.logs.unshift({ id: Date.now(), d: d, v: mode==='d' ? v*P : -v, p: mode==='d' ? v : 0, t: mode });
            localStorage.setItem('fedex_final_v49', JSON.stringify(db));
            document.getElementById('iVal').value = '';
            tab('home');
        }

        function calc() {
            const total = db.logs.reduce((a, b) => a + b.v, 0);
            const workDays = [...new Set(db.logs.filter(l => l.t === 'd').map(l => l.d))].length;
            const earn = db.logs.filter(l => l.t === 'd').reduce((a, b) => a + b.v, 0);
            const withDr = Math.abs(db.logs.filter(l => l.t === 'w').reduce((a, b) => a + b.v, 0));
            
            document.getElementById('atCompany').innerText = 'â‚¬' + total.toFixed(2);
            document.getElementById('sumEarn').innerText = earn.toFixed(1) + 'â‚¬';
            document.getElementById('sumWith').innerText = withDr.toFixed(1) + 'â‚¬';
            document.getElementById('netProfit').innerText = 'â‚¬' + (total - (workDays * G)).toFixed(2);
        }

        function hist() {
            const cont = document.getElementById('logContainer'); 
            cont.innerHTML = '';
            db.logs.forEach(l => {
                const title = l.t === 'd' ? 'ğŸ“¦ ' + l.p + ' Ø·Ø±Ø¯' : 'ğŸ’¸ Ø³Ø­Ø¨';
                const color = l.v > 0 ? 'text-purple-900' : 'text-orange-600';
                cont.innerHTML += `
                    <div class="bg-white p-5 rounded-2xl flex justify-between items-center card-shadow border border-slate-50">
                        <div>
                            <p class="text-[10px] font-bold text-slate-400">${l.d}</p>
                            <p class="font-black">${title}</p>
                        </div>
                        <div class="flex items-center gap-4">
                            <span class="font-black ${color}">â‚¬${Math.abs(l.v).toFixed(1)}</span>
                            <button onclick="del(${l.id})" class="text-red-200">ğŸ—‘ï¸</button>
                        </div>
                    </div>`;
            });
        }

        function exportCustomReport() {
            const from = document.getElementById('dateFrom').value;
            const to = document.getElementById('dateTo').value;
            const filtered = db.logs.filter(l => l.d >= from && l.d <= to && l.t === 'd').sort((a,b) => new Date(a.d) - new Date(b.d));
            if(!filtered.length) return alert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª');
            
            document.getElementById('repPeriod').innerText = 'Period: ' + from + ' to ' + to;
            const body = document.getElementById('repBody'); 
            body.innerHTML = '';
            let tP = 0, tV = 0;
            
            filtered.forEach(l => {
                tP += l.p; tV += l.v;
                body.innerHTML += `
                    <tr style="border-bottom:1px solid #eee;">
                        <td style="padding:15px;">${l.d}</td>
                        <td style="padding:15px;">${l.p}</td>
                        <td style="padding:15px;">â‚¬${l.v.toFixed(1)}</td>
                    </tr>`;
            });
            
            document.getElementById('repFooter').innerHTML = `
                <div><p style="font-size:12px;">PARCELS</p><h3 style="margin:0; font-size:24px;">${tP}</h3></div>
                <div><p style="font-size:12px;">TOTAL</p><h3 style="margin:0; font-size:24px;">â‚¬${tV.toFixed(2)}</h3></div>`;
            
            html2canvas(document.getElementById('renderArea')).then(canvas => {
                const link = document.createElement('a'); 
                link.download = 'FedEx_Invoice.png';
                link.href = canvas.toDataURL(); 
                link.click();
            });
        }

        function del(id) { 
            if(confirm('Ø­Ø°ÙØŸ')) { 
                db.logs = db.logs.filter(l => l.id !== id); 
                localStorage.setItem('fedex_final_v49', JSON.stringify(db)); 
                hist(); 
                calc(); 
            } 
        }

        function clearCurrentMonth() {
            const m = new Date().toISOString().slice(0, 7);
            if(confirm('Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠØŸ')) { 
                db.logs = db.logs.filter(l => !l.d.startsWith(m)); 
                localStorage.setItem('fedex_final_v49', JSON.stringify(db)); 
                hist(); 
                calc(); 
            }
        }
    </script>
</body>
</html>
